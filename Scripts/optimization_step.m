%% normal operation
        OPT_S = had_grad_step(SC,OPT_S,HAD_S,'both');
